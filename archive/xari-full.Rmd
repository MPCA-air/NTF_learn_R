



# 11| Automate it all - _easily update your analysis with new data_

__EXPLOSIONS!!!__

![](images\explosion.jpg){width=66%}


Oh crap. There was a big refinery explosion close to our monitoring site and we'll be receiving new monitoring data in the next hour. Our task is to to let people know if we see anything that suggests smoke from the explosion is reaching the air monitor.

----

We have data for 2014 and 2015, but we are currently living in the year 2016. Remember our data is stored in one Excel workbook. Since we wrote this in a script form, we can change the date in our `read_excel()` function as follows:

```{r, echo = T, eval = T, messsage = F, warning = F}
download.file("https://github.com/MPCA-air/NTF_learn_R/raw/master/data/PM_and_Ozone/Hourly_Fond_Du_Lac.xlsx", "data/Fond_data.xlsx", mode = "wb")

data_2016 <- read_excel("data/Fond_data.xlsx", sheet = "2016")

```


We changed the _year_ to 2016 and __BOOM!__ we've got updated data.
Now we can follow the same steps we used before to bind the tables togehter and join the MET data.


```{r, echo = T, eval = T, messsage = F, warning = F}

air_data <- bind_rows(data_2014, data_2015)
```



Then we join the met data:
```{r, eval=T, include=F, messsage = F, warning = F}
air_data$date_time <-  paste(ymd(air_data$Date), hms(paste(air_data$Hour, ":00:00")))

air_data$date_time <-  ymd_hms(air_data$date_time)

```


```{r, echo = T, eval = T, messsage = F, warning = F}
air_met <- left_join(air_data, fonddulac_met, by = c("date_time" = "time")) %>% select(-Time)

summary(air_met)
```


If you're ever wondering what tabs are available in an Excel workbook, you can run the function `excel_sheets()`.

```{r}
excel_sheets("data/Fond_data.xlsx")
```

---

# 12| Make maps and never get lost again

Where is that Fond Du Lac site again?
Was it close to the explosion? Let's take a quick look.

```{r, eval = F, echo = T, include = F, messsage = F, warning = F}
install.packages("leaflet")

``` 

```{r, eval = T, echo = T, messsage = F, warning = F}
library(leaflet)

# Reduce the table to a single row for each monitoring site
air_sites <- group_by(air_met, site_catid) %>% slice(1)

# Quick interactive map
leaflet(data = air_sites) %>%
        addTiles() %>%
        addMarkers(label = ~as.character(SiteNum), labelOptions = labelOptions(noHide = T))
``` 

Leaflet is friendly enough to guess your coordinate column names (Latitude and Longitude) whether they're in caps or lower case. __Go leaflet!__

```{r, eval=F, include=F}
![](https://camo.githubusercontent.com/5f5e0d9aac32bd5d0b49b5c6dfece9efe2ad577a/68747470733a2f2f7261772e6769746875622e636f6d2f706572727967656f2f6c6561666c65742d73696d706c652d6373762f6d61737465722f696d672f73637265656e73686f74312e706e67){width="60%"}
```


----

Remember the first pollutant rose we looked at? Let's load the Fond Du Lac data set into the tool to see if the refinery explosion could have potentially impacted the PM2.5 concentrations.

[Pollution rose for any data](https://air-data.shinyapps.io/pollution-roses/)


---

# 13| Online community + us

## Join the R community

![](images\rladies_map.gif){width="60%" align="right" style="margin-right:180px;"}


![](https://pbs.twimg.com/profile_images/611535712710729728/ZrqMrN21_400x400.jpg)

- `#rstats` Twitter
- RLadies
- Local R User groups
- Online courses and blogs
- International conferences

```{r, eval=F, include=F}
![](https://k-roz.com/img/rladies-dashboard.png)
```


---

# 14| It will compliment you and make jokes 

There are some _just for fun_ R packages. 

```{r, eval = F, echo = T, include = F, messsage = F, warning = F}
install.packages("cowsay")
install.packages("fortunes")
``` 

_cowsay_ outputs a variety of animals saying the quotes of your choice.

```{r, echo=T, eval=T, messsage = F, warning = F}
library(cowsay)
say("Meow, meow. You deserve a break.", "cat")
```


_fortunes_ will return fortunes or data-related quotes

```{r, echo = T, eval = T, messsage = F, warning = F}
set.seed(42)
library(fortunes)
fortune()
```

And for baseball fans there is an R package for baseball stats _Lahman_ and _pitchRx_. Good luck!

--- 

# Congratulations! 

![](https://assets.wired.com/photos/w_2048/wp-content/uploads/2015/02/catinbox_simba_by-jacme31.jpg){width="64%" align="right" style="margin-left: 35px; max-width: 64%"}

You've completed the Super fast R Intro. 

You are officially ready for Day 1 of R Camp. 

In the mean time you can find help on _R-Bloggers_, download the package _swirl_, Google R related questions, and take a Coursera course at https://www.coursera.org/specializations/jhu-data-science.

<br>

We want to meet you. Talk to us. Send us an e-mail. 

We are  Kristie.Ellickson@state.mn.us and Dorian.Kvale@state.mn.us

We like __R__. 

We aren't computer scientists and you don't need to be either.


---

# Back to GitHub

Return to this project's [GitHub page](https://github.com/MPCA-air/NTF_learn_R).

<br>
<hr>

![](http://placekitten.com/g/247/252)

<br><hr>


